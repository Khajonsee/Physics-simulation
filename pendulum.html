import React, { useState, useEffect, useRef } from 'react';

class Pendulum {
  constructor(length = 1.0, mass = 1.0, initialAngleDeg = 30.0, g = 9.81, dt = 0.02) {
    this.length = length;
    this.mass = mass;
    this.g = g;
    this.dt = dt;
    this.initialAngle = initialAngleDeg * Math.PI / 180;
    this.angle = this.initialAngle;
    this.angularVelocity = 0.0;
    this.time = 0.0;
    this.position = 0.0;
    this.velocity = 0.0;
    this.acceleration = 0.0;
    this.oscillationCount = 0;
    this.lastZeroCrossing = 0;
    this.measuredPeriod = 0;
  }

  updateParameters(length = null, mass = null, initialAngleDeg = null, g = null) {
    if (length !== null) this.length = length;
    if (mass !== null) this.mass = mass;
    if (initialAngleDeg !== null) this.initialAngle = initialAngleDeg * Math.PI / 180;
    if (g !== null) this.g = g;
    this.resetSimulation();
  }

  resetSimulation() {
    this.angle = this.initialAngle;
    this.angularVelocity = 0.0;
    this.time = 0.0;
    this.oscillationCount = 0;
    this.lastZeroCrossing = 0;
    this.measuredPeriod = 0;
    this.updatePhysicsValues();
  }

  step() {
    const prevAngle = this.angle;
    const angularAcceleration = -(this.g / this.length) * Math.sin(this.angle);
    this.angularVelocity += angularAcceleration * this.dt;
    this.angle += this.angularVelocity * this.dt;
    this.time += this.dt;

    if (prevAngle > 0 && this.angle <= 0 || prevAngle < 0 && this.angle >= 0) {
      if (this.lastZeroCrossing > 0) {
        this.measuredPeriod = (this.time - this.lastZeroCrossing) * 2;
        this.oscillationCount++;
      }
      this.lastZeroCrossing = this.time;
    }

    this.updatePhysicsValues();
  }

  updatePhysicsValues() {
    this.position = this.length * Math.sin(this.angle);
    this.velocity = this.length * this.angularVelocity;
    this.acceleration = -(this.g / this.length) * this.length * Math.sin(this.angle);
  }

  getCartesianCoordinates() {
    const x = this.length * Math.sin(this.angle);
    const y = this.length * Math.cos(this.angle);
    return [x, y];
  }

  getTheoreticalPeriod() {
    return 2 * Math.PI * Math.sqrt(this.length / this.g);
  }

  getTheoreticalFrequency() {
    return 1 / this.getTheoreticalPeriod();
  }
}

const PendulumLab = () => {
  const [studentInfo, setStudentInfo] = useState({
    firstName: '',
    lastName: '',
    grade: '',
    number: ''
  });

  const [length, setLength] = useState(1.0);
  const [angle, setAngle] = useState(15.0);
  const [gravity, setGravity] = useState(9.81);
  const [mass, setMass] = useState(0.5);
  const [running, setRunning] = useState(false);
  const [simulationSpeed, setSimulationSpeed] = useState(1.0);
  const [experimentData, setExperimentData] = useState([]);
  const [isRecording, setIsRecording] = useState(false);
  const [recordingStartTime, setRecordingStartTime] = useState(0);
  const [isReportOpen, setIsReportOpen] = useState(false);

  const canvasRef = useRef(null);
  const animationRef = useRef(null);
  const pendulumRef = useRef(new Pendulum(length, mass, angle, gravity));

  useEffect(() => {
    pendulumRef.current.updateParameters(length, mass, angle, gravity);
    drawPendulum();
  }, [length, angle, gravity, mass]);

  useEffect(() => {
    if (running) {
      animationRef.current = requestAnimationFrame(animate);
    } else {
      if (animationRef.current) {
        cancelAnimationFrame(animationRef.current);
      }
    }
    return () => {
      if (animationRef.current) {
        cancelAnimationFrame(animationRef.current);
      }
    };
  }, [running]);

  const drawPendulum = () => {
    const canvas = canvasRef.current;
    if (!canvas) return;

    const ctx = canvas.getContext('2d');
    const scale = 80;
    const centerX = canvas.width / 2;
    const pivotY = 30;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á
    const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
    gradient.addColorStop(0, '#87CEEB');
    gradient.addColorStop(1, '#98FB98');
    ctx.fillStyle = gradient;
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // ‡πÄ‡∏™‡πâ‡∏ô‡∏Å‡∏£‡∏¥‡∏î
    ctx.strokeStyle = '#e2e8f0';
    ctx.lineWidth = 1;
    for (let i = 0; i < canvas.width; i += 20) {
      ctx.beginPath();
      ctx.moveTo(i, 0);
      ctx.lineTo(i, canvas.height);
      ctx.stroke();
    }
    for (let i = 0; i < canvas.height; i += 20) {
      ctx.beginPath();
      ctx.moveTo(0, i);
      ctx.lineTo(canvas.width, i);
      ctx.stroke();
    }

    const [x, y] = pendulumRef.current.getCartesianCoordinates();
    const scaledX = x * scale;
    const scaledY = y * scale;

    // ‡∏à‡∏∏‡∏î‡πÅ‡∏Ç‡∏ß‡∏ô
    ctx.beginPath();
    ctx.arc(centerX, pivotY, 6, 0, Math.PI * 2);
    ctx.fillStyle = '#2d3748';
    ctx.fill();

    // ‡∏™‡∏≤‡∏¢‡πÅ‡∏Ç‡∏ß‡∏ô
    ctx.beginPath();
    ctx.moveTo(centerX, pivotY);
    ctx.lineTo(centerX + scaledX, pivotY + scaledY);
    ctx.strokeStyle = '#8b4513';
    ctx.lineWidth = 4;
    ctx.stroke();

    // ‡∏•‡∏π‡∏Å‡∏ï‡∏∏‡πâ‡∏°
    const bobRadius = 12;
    ctx.beginPath();
    ctx.arc(centerX + scaledX, pivotY + scaledY, bobRadius, 0, Math.PI * 2);
    ctx.fillStyle = '#8B4513';
    ctx.fill();
    ctx.strokeStyle = '#654321';
    ctx.lineWidth = 2;
    ctx.stroke();

    // ‡πÄ‡∏™‡πâ‡∏ô‡∏™‡πÄ‡∏Å‡∏•
    ctx.strokeStyle = '#4a5568';
    ctx.lineWidth = 1;
    const scaleLength = 80;
    ctx.beginPath();
    ctx.moveTo(centerX - scaleLength, canvas.height - 15);
    ctx.lineTo(centerX + scaleLength, canvas.height - 15);
    ctx.stroke();

    // ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡πÄ‡∏Å‡∏•
    ctx.font = '10px Arial';
    ctx.textAlign = 'center';
    ctx.fillStyle = '#4a5568';
    const halfScale = scaleLength / 2;
    ctx.fillText('-1.0m', centerX - scaleLength, canvas.height - 5);
    ctx.fillText('-0.5m', centerX - halfScale, canvas.height - 5);
    ctx.fillText('0', centerX, canvas.height - 5);
    ctx.fillText('0.5m', centerX + halfScale, canvas.height - 5);
    ctx.fillText('1.0m', centerX + scaleLength, canvas.height - 5);
  };

  const animate = () => {
    if (!running) return;

    const steps = Math.ceil(simulationSpeed * 2);
    for (let i = 0; i < steps; i++) {
      pendulumRef.current.step();
    }

    if (isRecording) {
      const currentTime = pendulumRef.current.time - recordingStartTime;
      const newDataPoint = {
        time: currentTime,
        angle: pendulumRef.current.angle * 180 / Math.PI,
        position: pendulumRef.current.position,
        velocity: pendulumRef.current.velocity,
        acceleration: pendulumRef.current.acceleration,
        energy: 0.5 * mass * Math.pow(pendulumRef.current.velocity, 2) + mass * gravity * (length - length * Math.cos(pendulumRef.current.angle))
      };
      setExperimentData(prev => [...prev, newDataPoint]);
    }

    drawPendulum();
    animationRef.current = requestAnimationFrame(animate);
  };

  const startSimulation = () => {
    setRunning(true);
    if (!isRecording) {
      setIsRecording(true);
      setRecordingStartTime(pendulumRef.current.time);
      setExperimentData([]);
    }
  };

  const stopSimulation = () => {
    setRunning(false);
    setIsRecording(false);
  };

  const resetSimulation = () => {
    setRunning(false);
    setIsRecording(false);
    if (animationRef.current) {
      cancelAnimationFrame(animationRef.current);
    }
    pendulumRef.current.resetSimulation();
    setExperimentData([]);
    drawPendulum();
  };

  const copyReportData = () => {
    const pendulum = pendulumRef.current;
    const currentDate = new Date().toLocaleDateString('th-TH', {
      year: 'numeric',
      month: 'long',
      day: 'numeric'
    });
    const currentTime = new Date().toLocaleTimeString('th-TH');

    let tableData = '‡∏•‡∏≥‡∏î‡∏±‡∏ö\t‡πÄ‡∏ß‡∏•‡∏≤ (s)\t‡∏°‡∏∏‡∏° (¬∞)\t‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á (m)\t‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß (m/s)\t‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πà‡∏á (m/s¬≤)\t‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô (J)\n';
    
    if (experimentData.length === 0) {
      for (let i = 0; i <= 20; i++) {
        const t = i * 0.1;
        const angleRad = angle * Math.PI / 180 * Math.cos(Math.sqrt(gravity / length) * t);
        const pos = length * Math.sin(angleRad);
        const vel = -length * angle * Math.PI / 180 * Math.sqrt(gravity / length) * Math.sin(Math.sqrt(gravity / length) * t);
        const acc = -gravity * Math.sin(angleRad);
        const energy = 0.5 * mass * vel * vel + mass * gravity * (length - length * Math.cos(angleRad));
        
        tableData += `${(i + 1)}\t${t.toFixed(3)}\t${(angleRad * 180 / Math.PI).toFixed(3)}\t${pos.toFixed(3)}\t${vel.toFixed(3)}\t${acc.toFixed(3)}\t${energy.toFixed(3)}\n`;
      }
    } else {
      experimentData.forEach((data, index) => {
        tableData += `${(index + 1)}\t${data.time.toFixed(3)}\t${data.angle.toFixed(3)}\t${data.position.toFixed(3)}\t${data.velocity.toFixed(3)}\t${data.acceleration.toFixed(3)}\t${data.energy.toFixed(3)}\n`;
      });
    }

    const reportText = `‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ö‡∏ö‡∏Æ‡∏≤‡∏£‡πå‡πÇ‡∏°‡∏ô‡∏¥‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏á‡πà‡∏≤‡∏¢ - ‡∏•‡∏π‡∏Å‡∏ï‡∏∏‡πâ‡∏°

‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏ó‡∏î‡∏•‡∏≠‡∏á:
‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•: ${studentInfo.firstName} ${studentInfo.lastName}
‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô: ${studentInfo.grade}
‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà: ${studentInfo.number}
‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á: ${currentDate}
‡πÄ‡∏ß‡∏•‡∏≤: ${currentTime}
‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á: ‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏ï‡∏∏‡πâ‡∏°

‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á:
‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏™‡∏≤‡∏¢ (L): ${length.toFixed(2)} ‡πÄ‡∏°‡∏ï‡∏£
‡∏°‡∏∏‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (Œ∏‚ÇÄ): ${angle.toFixed(1)} ‡∏≠‡∏á‡∏®‡∏≤
‡πÅ‡∏£‡∏á‡πÇ‡∏ô‡πâ‡∏°‡∏ñ‡πà‡∏ß‡∏á‡πÇ‡∏•‡∏Å (g): ${gravity.toFixed(2)} N/kg
‡∏°‡∏ß‡∏•‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏ï‡∏∏‡πâ‡∏° (m): ${mass.toFixed(2)} ‡∏Å‡∏¥‡πÇ‡∏•‡∏Å‡∏£‡∏±‡∏°

‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ó‡∏≤‡∏á‡∏ó‡∏§‡∏©‡∏é‡∏µ:
‡∏Ñ‡∏≤‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡∏ß‡πà‡∏á (T): ${pendulum.getTheoreticalPeriod().toFixed(4)} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà (f): ${pendulum.getTheoreticalFrequency().toFixed(4)} ‡πÄ‡∏Æ‡∏¥‡∏£‡πå‡∏ï
‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà‡πÄ‡∏ä‡∏¥‡∏á‡∏°‡∏∏‡∏° (œâ): ${(2 * Math.PI * pendulum.getTheoreticalFrequency()).toFixed(4)} ‡πÄ‡∏£‡πÄ‡∏î‡∏µ‡∏¢‡∏ô/‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πà‡∏á‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (a_max): ${(gravity * Math.sin(angle * Math.PI / 180)).toFixed(4)} ‡πÄ‡∏°‡∏ï‡∏£/‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ¬≤

‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà:
x(t) = A sin(œât + œÜ)
v(t) = Aœâ cos(œât + œÜ)
a(t) = -Aœâ¬≤ sin(œât + œÜ)
T = 2œÄ‚àö(L/g)
f = 1/T

‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:
${tableData}

‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á:
‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå: ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ö‡∏ö‡∏Æ‡∏≤‡∏£‡πå‡πÇ‡∏°‡∏ô‡∏¥‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏ï‡∏∏‡πâ‡∏° ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏≤‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡∏ß‡πà‡∏á

‡∏Ç‡πâ‡∏≠‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï:
- ‡∏Ñ‡∏≤‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡∏ß‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏ï‡∏∏‡πâ‡∏°‡πÑ‡∏°‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏°‡∏ß‡∏•‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏ï‡∏∏‡πâ‡∏°
- ‡∏Ñ‡∏≤‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡∏ß‡πà‡∏á‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ç‡∏≠‡∏á‡πÄ‡∏ä‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô
- ‡∏Ñ‡∏≤‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡∏ß‡πà‡∏á‡∏à‡∏∞‡∏•‡∏î‡∏•‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏£‡∏á‡πÇ‡∏ô‡πâ‡∏°‡∏ñ‡πà‡∏ß‡∏á‡πÇ‡∏•‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô
- ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∏‡∏°‡πÄ‡∏•‡πá‡∏Å (< 15¬∞) ‡∏™‡∏°‡∏Å‡∏≤‡∏£ T = 2œÄ‚àö(L/g) ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥

‡∏™‡∏£‡∏∏‡∏õ: ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏ï‡∏∏‡πâ‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ö‡∏ö‡∏Æ‡∏≤‡∏£‡πå‡πÇ‡∏°‡∏ô‡∏¥‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏á‡πà‡∏≤‡∏¢ ‡πÇ‡∏î‡∏¢‡∏Ñ‡∏≤‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡∏ß‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ç‡∏≠‡∏á‡∏™‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡πÅ‡∏£‡∏á‡πÇ‡∏ô‡πâ‡∏°‡∏ñ‡πà‡∏ß‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÑ‡∏°‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏°‡∏ß‡∏•‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏ï‡∏∏‡πâ‡∏°

‡πÇ‡∏î‡∏¢‡∏Ñ‡∏£‡∏π‡∏Ç‡∏à‡∏£‡∏®‡∏£‡∏µ ‡∏™‡∏∏‡∏ó‡∏ò‡∏™‡∏±‡∏á‡∏Ç‡πå ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏•‡∏≠‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤ ‡∏à.‡πÅ‡∏û‡∏£‡πà`;

    navigator.clipboard.writeText(reportText).then(() => {
      alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!\n‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡πÉ‡∏ô Microsoft Word ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢');
    }).catch(() => {
      const textarea = document.createElement('textarea');
      textarea.value = reportText;
      textarea.style.position = 'fixed';
      textarea.style.left = '-9999px';
      textarea.style.top = '-9999px';
      document.body.appendChild(textarea);
      textarea.focus();
      textarea.select();
      const success = document.execCommand('copy');
      document.body.removeChild(textarea);
      
      if (success) {
        alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!\n‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡πÉ‡∏ô Microsoft Word ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢');
      } else {
        alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
      }
    });
  };

  const showReport = () => {
    if (!studentInfo.firstName && !studentInfo.lastName && !studentInfo.grade && !studentInfo.number) {
      alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏ä‡πà‡∏≠‡∏á');
      return;
    }
    setIsReportOpen(true);
  };

  const pendulum = pendulumRef.current;

  return (
    <div style={{
      margin: 0,
      padding: 0,
      boxSizing: 'border-box',
      fontFamily: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",
      background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
      minHeight: '100vh',
      padding: '10px'
    }}>
      <div style={{
        maxWidth: '1200px',
        margin: '0 auto',
        background: 'rgba(255, 255, 255, 0.95)',
        borderRadius: '15px',
        boxShadow: '0 10px 30px rgba(0, 0, 0, 0.1)',
        overflow: 'hidden'
      }}>
        {/* Header */}
        <div style={{
          background: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',
          color: 'white',
          padding: '20px 15px',
          textAlign: 'center'
        }}>
          <h1 style={{
            fontSize: 'clamp(1.5rem, 4vw, 2.5rem)',
            marginBottom: '8px',
            textShadow: '2px 2px 4px rgba(0, 0, 0, 0.3)',
            margin: 0
          }}>
            üî¨ ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ö‡∏ö‡∏Æ‡∏≤‡∏£‡πå‡∏°‡∏≠‡∏ô‡∏¥‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏á‡πà‡∏≤‡∏¢
          </h1>
          <p style={{
            fontSize: 'clamp(0.9rem, 2.5vw, 1.1rem)',
            opacity: 0.9,
            margin: 0
          }}>
            ‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏ï‡∏∏‡πâ‡∏°
          </p>
        </div>

        {/* Main Content */}
        <div style={{
          display: 'grid',
          gridTemplateColumns: window.innerWidth >= 1024 ? '1fr 2fr' : '1fr',
          gap: '20px',
          padding: '15px'
        }}>
          {/* Control Panel */}
          <div style={{
            background: '#f8f9fa',
            borderRadius: '12px',
            padding: '15px',
            boxShadow: '0 3px 10px rgba(0, 0, 0, 0.08)'
          }}>
            {/* Student Info */}
            <div style={{
              background: 'white',
              borderRadius: '8px',
              padding: '15px',
              marginBottom: '20px',
              borderLeft: '4px solid #4facfe'
            }}>
              <h3 style={{
                color: '#333',
                marginBottom: '12px',
                fontSize: 'clamp(1rem, 3vw, 1.2rem)',
                marginTop: 0
              }}>
                üìù ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏ó‡∏î‡∏•‡∏≠‡∏á
              </h3>
              <div style={{ marginBottom: '12px' }}>
                <label style={{
                  display: 'block',
                  marginBottom: '4px',
                  color: '#555',
                  fontWeight: '500',
                  fontSize: 'clamp(0.85rem, 2.5vw, 0.9rem)'
                }}>
                  ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:
                </label>
                <input
                  style={{
                    width: '100%',
                    padding: '12px 10px',
                    border: '2px solid #e1e5e9',
                    borderRadius: '6px',
                    fontSize: 'clamp(14px, 3vw, 16px)',
                    outline: 'none'
                  }}
                  type="text"
                  placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•"
                  value={`${studentInfo.firstName} ${studentInfo.lastName}`}
                  onChange={(e) => {
                    const names = e.target.value.split(' ');
                    setStudentInfo({
                      ...studentInfo,
                      firstName: names[0] || '',
                      lastName: names.slice(1).join(' ') || ''
                    });
                  }}
                />
              </div>
              <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '8px' }}>
                <div style={{ marginBottom: '12px' }}>
                  <label style={{
                    display: 'block',
                    marginBottom: '4px',
                    color: '#555',
                    fontWeight: '500',
                    fontSize: 'clamp(0.85rem, 2.5vw, 0.9rem)'
                  }}>
                    ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô:
                  </label>
                  <input
                    style={{
                      width: '100%',
                      padding: '12px 10px',
                      border: '2px solid #e1e5e9',
                      borderRadius: '6px',
                      fontSize: 'clamp(14px, 3vw, 16px)',
                      outline: 'none'
                    }}
                    type="text"
                    placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏°.4/1"
                    value={studentInfo.grade}
                    onChange={(e) => setStudentInfo({...studentInfo, grade: e.target.value})}
                  />
                </div>
                <div style={{ marginBottom: '12px' }}>
                  <label style={{
                    display: 'block',
                    marginBottom: '4px',
                    color: '#555',
                    fontWeight: '500',
                    fontSize: 'clamp(0.85rem, 2.5vw, 0.9rem)'
                  }}>
                    ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà:
                  </label>
                  <input
                    style={{
                      width: '100%',
                      padding: '12px 10px',
                      border: '2px solid #e1e5e9',
                      borderRadius: '6px',
                      fontSize: 'clamp(14px, 3vw, 16px)',
                      outline: 'none'
                    }}
                    type="number"
                    placeholder="‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà"
                    value={studentInfo.number}
                    onChange={(e) => setStudentInfo({...studentInfo, number: e.target.value})}
                  />
                </div>
              </div>
            </div>

            {/* Experiment Controls */}
            <div style={{
              background: 'white',
              borderRadius: '8px',
              padding: '15px',
              borderLeft: '4px solid #28a745'
            }}>
              <h3 style={{
                color: '#333',
                marginBottom: '12px',
                fontSize: 'clamp(1rem, 3vw, 1.2rem)',
                marginTop: 0
              }}>
                ‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á
              </h3>
              
              <div style={{ marginBottom: '18px' }}>
                <label style={{
                  display: 'block',
                  marginBottom: '8px',
                  color: '#555',
                  fontWeight: '500',
                  fontSize: 'clamp(0.85rem, 2.5vw, 0.9rem)'
                }}>
                  ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏™‡∏≤‡∏¢ (m): <span style={{
                    display: 'inline-block',
                    background: '#e3f2fd',
                    padding: '6px 12px',
                    borderRadius: '4px',
                    marginLeft: '8px',
                    fontWeight: 'bold',
                    color: '#1976d2',
                    minWidth: '60px',
                    textAlign: 'center',
                    fontSize: 'clamp(0.8rem, 2.5vw, 0.9rem)'
                  }}>{length.toFixed(1)}</span>
                </label>
                <input
                  style={{
                    width: '100%',
                    height: '8px',
                    borderRadius: '4px',
                    background: '#ddd',
                    outline: 'none',
                    WebkitAppearance: 'none',
                    touchAction: 'manipulation'
                  }}
                  type="range"
                  min="0.5"
                  max="2.0"
                  step="0.1"
                  value={length}
                  onChange={(e) => setLength(parseFloat(e.target.value))}
                  disabled={running}
                />
              </div>

              <div style={{ marginBottom: '18px' }}>
                <label style={{
                  display: 'block',
                  marginBottom: '8px',
                  color: '#555',
                  fontWeight: '500',
                  fontSize: 'clamp(0.85rem, 2.5vw, 0.9rem)'
                }}>
                  ‡∏°‡∏∏‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (¬∞): <span style={{
                    display: 'inline-block',
                    background: '#e3f2fd',
                    padding: '6px 12px',
                    borderRadius: '4px',
                    marginLeft: '8px',
                    fontWeight: 'bold',
                    color: '#1976d2',
                    minWidth: '60px',
                    textAlign: 'center',
                    fontSize: 'clamp(0.8rem, 2.5vw, 0.9rem)'
                  }}>{angle.toFixed(0)}</span>
                </label>
                <input
                  style={{
                    width: '100%',
                    height: '8px',
                    borderRadius: '4px',
                    background: '#ddd',
                    outline: 'none',
                    WebkitAppearance: 'none',
                    touchAction: 'manipulation'
                  }}
                  type="range"
                  min="5"
                  max="45"
                  step="1"
                  value={angle}
                  onChange={(e) => setAngle(parseFloat(e.target.value))}
                  disabled={running}
                />
              </div>

              <div style={{ marginBottom: '18px' }}>
                <label style={{
                  display: 'block',
                  marginBottom: '8px',
                  color: '#555',
                  fontWeight: '500',
                  fontSize: 'clamp(0.85rem, 2.5vw, 0.9rem)'
                }}>
                  ‡πÅ‡∏£‡∏á‡πÇ‡∏ô‡πâ‡∏°‡∏ñ‡πà‡∏ß‡∏á (N/kg): <span style={{
                    display: 'inline-block',
                    background: '#e3f2fd',
                    padding: '6px 12px',
                    borderRadius: '4px',
                    marginLeft: '8px',
                    fontWeight: 'bold',
                    color: '#1976d2',
                    minWidth: '60px',
                    textAlign: 'center',
                    fontSize: 'clamp(0.8rem, 2.5vw, 0.9rem)'
                  }}>{gravity.toFixed(1)}</span>
                </label>
                <input
                  style={{
                    width: '100%',
                    height: '8px',
                    borderRadius: '4px',
                    background: '#ddd',
                    outline: 'none',
                    WebkitAppearance: 'none',
                    touchAction: 'manipulation'
                  }}
                  type="range"
                  min="5.0"
                  max="15.0"
                  step="0.1"
                  value={gravity}
                  onChange={(e) => setGravity(parseFloat(e.target.value))}
                  disabled={running}
                />
              </div>

              <div style={{ marginBottom: '18px' }}>
                <label style={{
                  display: 'block',
                  marginBottom: '8px',
                  color: '#555',
                  fontWeight: '500',
                  fontSize: 'clamp(0.85rem, 2.5vw, 0.9rem)'
                }}>
                  ‡∏°‡∏ß‡∏• (kg): <span style={{
                    display: 'inline-block',
                    background: '#e3f2fd',
                    padding: '6px 12px',
                    borderRadius: '4px',
                    marginLeft: '8px',
                    fontWeight: 'bold',
                    color: '#1976d2',
                    minWidth: '60px',
                    textAlign: 'center',
                    fontSize: 'clamp(0.8rem, 2.5vw, 0.9rem)'
                  }}>{mass.toFixed(1)}</span>
                </label>
                <input
                  style={{
                    width: '100%',
                    height: '8px',
                    borderRadius: '4px',
                    background: '#ddd',
                    outline: 'none',
                    WebkitAppearance: 'none',
                    touchAction: 'manipulation'
                  }}
                  type="range"
                  min="0.1"
                  max="2.0"
                  step="0.1"
                  value={mass}
                  onChange={(e) => setMass(parseFloat(e.target.value))}
                  disabled={running}
                />
              </div>

              <div style={{ marginBottom: '18px' }}>
                <label style={{
                  display: 'block',
                  marginBottom: '8px',
                  color: '#555',
                  fontWeight: '500',
                  fontSize: 'clamp(0.85rem, 2.5vw, 0.9rem)'
                }}>
                  ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏•‡∏≠‡∏á: <span style={{
                    display: 'inline-block',
                    background: '#e3f2fd',
                    padding: '6px 12px',
                    borderRadius: '4px',
                    marginLeft: '8px',
                    fontWeight: 'bold',
                    color: '#1976d2',
                    minWidth: '60px',
                    textAlign: 'center',
                    fontSize: 'clamp(0.8rem, 2.5vw, 0.9rem)'
                  }}>
                    {simulationSpeed === 0.25 ? '‡∏ä‡πâ‡∏≤‡∏°‡∏≤‡∏Å' :
                     simulationSpeed === 0.5 ? '‡∏ä‡πâ‡∏≤' :
                     simulationSpeed === 0.75 ? '‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏ä‡πâ‡∏≤' :
                     simulationSpeed === 1.0 ? '‡∏õ‡∏Å‡∏ï‡∏¥' :
                     simulationSpeed === 1.25 ? '‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏£‡πá‡∏ß' :
                     simulationSpeed === 1.5 ? '‡πÄ‡∏£‡πá‡∏ß' :
                     simulationSpeed === 1.75 ? '‡πÄ‡∏£‡πá‡∏ß‡∏°‡∏≤‡∏Å' :
                     simulationSpeed === 2.0 ? '‡πÄ‡∏£‡πá‡∏ß‡∏™‡∏∏‡∏î' : '‡∏õ‡∏Å‡∏ï‡∏¥'}
                  </span>
                </label>
                <input
                  style={{
                    width: '100%',
                    height: '8px',
                    borderRadius: '4px',
                    background: '#ddd',
                    outline: 'none',
                    WebkitAppearance: 'none',
                    touchAction: 'manipulation'
                  }}
                  type="range"
                  min="0.25"
                  max="2.0"
                  step="0.25"
                  value={simulationSpeed}
                  onChange={(e) => setSimulationSpeed(parseFloat(e.target.value))}
                />
              </div>

              <div style={{
                display: 'grid',
                gridTemplateColumns: 'repeat(3, 1fr)',
                gap: '8px',
                margin: '15px 0'
              }}>
                <button
                  style={{
                    padding: '12px 8px',
                    border: 'none',
                    borderRadius: '6px',
                    fontSize: 'clamp(12px, 2.5vw, 14px)',
                    fontWeight: '500',
                    cursor: 'pointer',
                    background: running ? '#9CA3AF' : 'linear-gradient(135deg, #28a745, #20c997)',
                    color: 'white',
                    textTransform: 'uppercase',
                    letterSpacing: '0.5px',
                    touchAction: 'manipulation'
                  }}
                  onClick={startSimulation}
                  disabled={running}
                >
                  ‚ñ∂Ô∏è ‡πÄ‡∏£‡∏¥‡πà‡∏°
                </button>
                <button
                  style={{
                    padding: '12px 8px',
                    border: 'none',
                    borderRadius: '6px',
                    fontSize: 'clamp(12px, 2.5vw, 14px)',
                    fontWeight: '500',
                    cursor: 'pointer',
                    background: !running ? '#9CA3AF' : 'linear-gradient(135deg, #6c757d, #495057)',
                    color: 'white',
                    textTransform: 'uppercase',
                    letterSpacing: '0.5px',
                    touchAction: 'manipulation'
                  }}
                  onClick={stopSimulation}
                  disabled={!running}
                >
                  ‚è∏Ô∏è ‡∏´‡∏¢‡∏∏‡∏î
                </button>
                <button
                  style={{
                    padding: '12px 8px',
                    border: 'none',
                    borderRadius: '6px',
                    fontSize: 'clamp(12px, 2.5vw, 14px)',
                    fontWeight: '500',
                    cursor: 'pointer',
                    background: 'linear-gradient(135deg, #ffc107, #fd7e14)',
                    color: 'white',
                    textTransform: 'uppercase',
                    letterSpacing: '0.5px',
                    touchAction: 'manipulation'
                  }}
                  onClick={resetSimulation}
                >
                  üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï
                </button>
              </div>

              <button
                style={{
                  background: 'linear-gradient(135deg, #17a2b8, #138496)',
                  color: 'white',
                  marginTop: '15px',
                  width: '100%',
                  padding: '12px 8px',
                  border: 'none',
                  borderRadius: '6px',
                  fontSize: 'clamp(12px, 2.5vw, 14px)',
                  fontWeight: '500',
                  cursor: 'pointer',
                  textTransform: 'uppercase',
                  letterSpacing: '0.5px',
                  touchAction: 'manipulation'
                }}
                onClick={showReport}
              >
                üìä ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á
              </button>
            </div>
          </div>

          {/* Simulation Area */}
          <div style={{
            background: 'white',
            borderRadius: '12px',
            padding: '15px',
            boxShadow: '0 3px 10px rgba(0, 0, 0, 0.08)'
          }}>
            <div style={{
              position: 'relative',
              border: '2px solid #e1e5e9',
              borderRadius: '8px',
              overflow: 'hidden',
              marginBottom: '15px',
              width: '100%'
            }}>
              <canvas
                ref={canvasRef}
                width={600}
                height={400}
                style={{
                  display: 'block',
                  background: 'linear-gradient(to bottom, #87CEEB 0%, #98FB98 100%)',
                  width: '100%',
                  height: 'auto',
                  maxWidth: '100%'
                }}
              />
            </div>

            <div style={{
              display: 'grid',
              gridTemplateColumns: 'repeat(auto-fit, minmax(120px, 1fr))',
              gap: '10px',
              marginTop: '15px'
            }}>
              <div style={{
                background: '#f8f9fa',
                padding: '12px',
                borderRadius: '6px',
                borderLeft: '4px solid #dc3545',
                textAlign: 'center'
              }}>
                <h4 style={{
                  color: '#333',
                  marginBottom: '8px',
                  fontSize: 'clamp(0.8rem, 2.5vw, 1rem)',
                  margin: '0 0 8px 0'
                }}>
                  ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á (m)
                </h4>
                <div style={{
                  fontSize: 'clamp(1rem, 3vw, 1.5rem)',
                  fontWeight: 'bold',
                  color: '#dc3545'
                }}>
                  {pendulum.position.toFixed(3)}
                </div>
              </div>
              <div style={{
                background: '#f8f9fa',
                padding: '12px',
                borderRadius: '6px',
                borderLeft: '4px solid #dc3545',
                textAlign: 'center'
              }}>
                <h4 style={{
                  color: '#333',
                  marginBottom: '8px',
                  fontSize: 'clamp(0.8rem, 2.5vw, 1rem)',
                  margin: '0 0 8px 0'
                }}>
                  ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß (m/s)
                </h4>
                <div style={{
                  fontSize: 'clamp(1rem, 3vw, 1.5rem)',
                  fontWeight: 'bold',
                  color: '#dc3545'
                }}>
                  {pendulum.velocity.toFixed(3)}
                </div>
              </div>
              <div style={{
                background: '#f8f9fa',
                padding: '12px',
                borderRadius: '6px',
                borderLeft: '4px solid #dc3545',
                textAlign: 'center'
              }}>
                <h4 style={{
                  color: '#333',
                  marginBottom: '8px',
                  fontSize: 'clamp(0.8rem, 2.5vw, 1rem)',
                  margin: '0 0 8px 0'
                }}>
                  ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πà‡∏á (m/s¬≤)
                </h4>
                <div style={{
                  fontSize: 'clamp(1rem, 3vw, 1.5rem)',
                  fontWeight: 'bold',
                  color: '#dc3545'
                }}>
                  {pendulum.acceleration.toFixed(3)}
                </div>
              </div>
            </div>
          </div>
        </div>

        {/* Results Section */}
        <div style={{
          marginTop: '20px',
          background: '#f8f9fa',
          borderRadius: '12px',
          padding: '15px',
          margin: '20px 15px 0 15px'
        }}>
          <h3 style={{
            color: '#333',
            marginBottom: '15px',
            textAlign: 'center',
            fontSize: 'clamp(1rem, 3vw, 1.2rem)',
            margin: '0 0 15px 0'
          }}>
            üìä ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á
          </h3>
          <div style={{
            display: 'grid',
            gridTemplateColumns: 'repeat(auto-fit, minmax(140px, 1fr))',
            gap: '10px'
          }}>
            <div style={{
              background: 'white',
              padding: '12px',
              borderRadius: '6px',
              textAlign: 'center',
              boxShadow: '0 2px 6px rgba(0, 0, 0, 0.1)'
            }}>
              <label style={{
                display: 'block',
                color: '#666',
                marginBottom: '4px',
                fontSize: 'clamp(0.75rem, 2vw, 0.9rem)'
              }}>
                ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà (Hz)
              </label>
              <div style={{
                fontSize: 'clamp(1rem, 2.5vw, 1.2rem)',
                fontWeight: 'bold',
                color: '#333'
              }}>
                {pendulum.getTheoreticalFrequency().toFixed(3)}
              </div>
            </div>
            <div style={{
              background: 'white',
              padding: '12px',
              borderRadius: '6px',
              textAlign: 'center',
              boxShadow: '0 2px 6px rgba(0, 0, 0, 0.1)'
            }}>
              <label style={{
                display: 'block',
                color: '#666',
                marginBottom: '4px',
                fontSize: 'clamp(0.75rem, 2vw, 0.9rem)'
              }}>
                ‡∏Ñ‡∏≤‡∏ö (s)
              </label>
              <div style={{
                fontSize: 'clamp(1rem, 2.5vw, 1.2rem)',
                fontWeight: 'bold',
                color: '#333'
              }}>
                {pendulum.getTheoreticalPeriod().toFixed(3)}
              </div>
            </div>
            <div style={{
              background: 'white',
              padding: '12px',
              borderRadius: '6px',
              textAlign: 'center',
              boxShadow: '0 2px 6px rgba(0, 0, 0, 0.1)'
            }}>
              <label style={{
                display: 'block',
                color: '#666',
                marginBottom: '4px',
                fontSize: 'clamp(0.75rem, 2vw, 0.9rem)'
              }}>
                ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà‡πÄ‡∏ä‡∏¥‡∏á‡∏°‡∏∏‡∏° (rad/s)
              </label>
              <div style={{
                fontSize: 'clamp(1rem, 2.5vw, 1.2rem)',
                fontWeight: 'bold',
                color: '#333'
              }}>
                {(2 * Math.PI * pendulum.getTheoreticalFrequency()).toFixed(3)}
              </div>
            </div>
            <div style={{
              background: 'white',
              padding: '12px',
              borderRadius: '6px',
              textAlign: 'center',
              boxShadow: '0 2px 6px rgba(0, 0, 0, 0.1)'
            }}>
              <label style={{
                display: 'block',
                color: '#666',
                marginBottom: '4px',
                fontSize: 'clamp(0.75rem, 2vw, 0.9rem)'
              }}>
                ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πà‡∏á‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (m/s¬≤)
              </label>
              <div style={{
                fontSize: 'clamp(1rem, 2.5vw, 1.2rem)',
                fontWeight: 'bold',
                color: '#333'
              }}>
                {(gravity * Math.sin(angle * Math.PI / 180)).toFixed(3)}
              </div>
            </div>
          </div>
        </div>

        {/* Credit Section */}
        <div style={{
          background: 'white',
          textAlign: 'center',
          padding: '15px',
          margin: '15px',
          borderRadius: '12px',
          boxShadow: '0 3px 10px rgba(0, 0, 0, 0.08)',
          color: '#666',
          fontStyle: 'italic',
          fontSize: 'clamp(0.8rem, 2.5vw, 0.9rem)'
        }}>
          ‡πÇ‡∏î‡∏¢‡∏Ñ‡∏£‡∏π‡∏Ç‡∏à‡∏£‡∏®‡∏£‡∏µ ‡∏™‡∏∏‡∏ó‡∏ò‡∏™‡∏±‡∏á‡∏Ç‡πå ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏•‡∏≠‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤ ‡∏à.‡πÅ‡∏û‡∏£‡πà
        </div>
      </div>

      {/* Modal for Report */}
      {isReportOpen && (
        <div style={{
          position: 'fixed',
          zIndex: 1000,
          left: 0,
          top: 0,
          width: '100%',
          height: '100%',
          backgroundColor: 'rgba(0, 0, 0, 0.8)',
          backdropFilter: 'blur(3px)',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center'
        }}>
          <div style={{
            backgroundColor: 'white',
            margin: '2% auto',
            padding: 0,
            borderRadius: '12px',
            width: '95%',
            maxWidth: '900px',
            maxHeight: '90vh',
            overflowY: 'auto',
            boxShadow: '0 15px 35px rgba(0, 0, 0, 0.3)'
          }}>
            <div style={{
              background: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',
              color: 'white',
              padding: '15px 20px',
              borderRadius: '12px 12px 0 0',
              display: 'flex',
              justifyContent: 'space-between',
              alignItems: 'center'
            }}>
              <h2 style={{
                margin: 0,
                fontSize: 'clamp(1.2rem, 3vw, 1.8rem)'
              }}>
                üìã ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ö‡∏ö‡∏Æ‡∏≤‡∏£‡πå‡∏°‡∏≠‡∏ô‡∏¥‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏á‡πà‡∏≤‡∏¢
              </h2>
              <span
                style={{
                  color: 'white',
                  fontSize: 'clamp(28px, 5vw, 35px)',
                  fontWeight: 'bold',
                  cursor: 'pointer',
                  lineHeight: 1,
                  padding: '5px'
                }}
                onClick={() => setIsReportOpen(false)}
              >
                √ó
              </span>
            </div>

            <div style={{
              padding: '20px',
              lineHeight: 1.6,
              fontSize: 'clamp(0.85rem, 2.5vw, 1rem)'
            }}>
              {/* ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏ó‡∏î‡∏•‡∏≠‡∏á */}
              <div style={{ marginBottom: '25px' }}>
                <h3 style={{
                  color: '#2c3e50',
                  borderBottom: '3px solid #3498db',
                  paddingBottom: '8px',
                  marginBottom: '15px',
                  fontSize: 'clamp(1.1rem, 3vw, 1.4rem)',
                  margin: '0 0 15px 0'
                }}>
                  üìù ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏ó‡∏î‡∏•‡∏≠‡∏á
                </h3>
                <div style={{
                  display: 'grid',
                  gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',
                  gap: '12px',
                  marginBottom: '15px'
                }}>
                  <div style={{
                    background: '#f8f9fa',
                    padding: '12px',
                    borderRadius: '6px',
                    borderLeft: '4px solid #3498db'
                  }}>
                    <strong style={{
                      color: '#2c3e50',
                      display: 'block',
                      marginBottom: '4px',
                      fontSize: 'clamp(0.8rem, 2.5vw, 0.9rem)'
                    }}>
                      ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:
                    </strong>
                    {studentInfo.firstName} {studentInfo.lastName}
                  </div>
                  <div style={{
                    background: '#f8f9fa',
                    padding: '12px',
                    borderRadius: '6px',
                    borderLeft: '4px solid #3498db'
                  }}>
                    <strong style={{
                      color: '#2c3e50',
                      display: 'block',
                      marginBottom: '4px',
                      fontSize: 'clamp(0.8rem, 2.5vw, 0.9rem)'
                    }}>
                      ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô:
                    </strong>
                    {studentInfo.grade}
                  </div>
                  <div style={{
                    background: '#f8f9fa',
                    padding: '12px',
                    borderRadius: '6px',
                    borderLeft: '4px solid #3498db'
                  }}>
                    <strong style={{
                      color: '#2c3e50',
                      display: 'block',
                      marginBottom: '4px',
                      fontSize: 'clamp(0.8rem, 2.5vw, 0.9rem)'
                    }}>
                      ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà:
                    </strong>
                    {studentInfo.number}
                  </div>
                  <div style={{
                    background: '#f8f9fa',
                    padding: '12px',
                    borderRadius: '6px',
                    borderLeft: '4px solid #3498db'
                  }}>
                    <strong style={{
                      color: '#2c3e50',
                      display: 'block',
                      marginBottom: '4px',
                      fontSize: 'clamp(0.8rem, 2.5vw, 0.9rem)'
                    }}>
                      ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á:
                    </strong>
                    {new Date().toLocaleDateString('th-TH', {
                      year: 'numeric',
                      month: 'long',
                      day: 'numeric'
                    })}
                  </div>
                  <div style={{
                    background: '#f8f9fa',
                    padding: '12px',
                    borderRadius: '6px',
                    borderLeft: '4px solid #3498db'
                  }}>
                    <strong style={{
                      color: '#2c3e50',
                      display: 'block',
                      marginBottom: '4px',
                      fontSize: 'clamp(0.8rem, 2.5vw, 0.9rem)'
                    }}>
                      ‡πÄ‡∏ß‡∏•‡∏≤:
                    </strong>
                    {new Date().toLocaleTimeString('th-TH')}
                  </div>
                  <div style={{
                    background: '#f8f9fa',
                    padding: '12px',
                    borderRadius: '6px',
                    borderLeft: '4px solid #3498db'
                  }}>
                    <strong style={{
                      color: '#2c3e50',
                      display: 'block',
                      marginBottom: '4px',
                      fontSize: 'clamp(0.8rem, 2.5vw, 0.9rem)'
                    }}>
                      ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á:
                    </strong>
                    ‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏ï‡∏∏‡πâ‡∏°
                  </div>
                </div>
              </div>

              {/* ‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á */}
              <div style={{ marginBottom: '25px' }}>
                <h3 style={{
                  color: '#2c3e50',
                  borderBottom: '3px solid #3498db',
                  paddingBottom: '8px',
                  marginBottom: '15px',
                  fontSize: 'clamp(1.1rem, 3vw, 1.4rem)',
                  margin: '0 0 15px 0'
                }}>
                  ‚öôÔ∏è ‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á
                </h3>
                <div style={{
                  display: 'grid',
                  gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',
                  gap: '12px',
                  marginBottom: '15px'
                }}>
                  <div style={{
                    background: '#f8f9fa',
                    padding: '12px',
                    borderRadius: '6px',
                    borderLeft: '4px solid #3498db'
                  }}>
                    <strong style={{
                      color: '#2c3e50',
                      display: 'block',
                      marginBottom: '4px',
                      fontSize: 'clamp(0.8rem, 2.5vw, 0.9rem)'
                    }}>
                      ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏™‡∏≤‡∏¢ (L):
                    </strong>
                    {length.toFixed(1)} ‡πÄ‡∏°‡∏ï‡∏£
                  </div>
                  <div style={{
                    background: '#f8f9fa',
                    padding: '12px',
                    borderRadius: '6px',
                    borderLeft: '4px solid #3498db'
                  }}>
                    <strong style={{
                      color: '#2c3e50',
                      display: 'block',
                      marginBottom: '4px',
                      fontSize: 'clamp(0.8rem, 2.5vw, 0.9rem)'
                    }}>
                      ‡∏°‡∏∏‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (Œ∏‚ÇÄ):
                    </strong>
                    {angle.toFixed(1)} ‡∏≠‡∏á‡∏®‡∏≤
                  </div>
                  <div style={{
                    background: '#f8f9fa',
                    padding: '12px',
                    borderRadius: '6px',
                    borderLeft: '4px solid #3498db'
                  }}>
                    <strong style={{
                      color: '#2c3e50',
                      display: 'block',
                      marginBottom: '4px',
                      fontSize: 'clamp(0.8rem, 2.5vw, 0.9rem)'
                    }}>
                      ‡πÅ‡∏£‡∏á‡πÇ‡∏ô‡πâ‡∏°‡∏ñ‡πà‡∏ß‡∏á‡πÇ‡∏•‡∏Å (g):
                    </strong>
                    {gravity.toFixed(2)} N/kg
                  </div>
                  <div style={{
                    background: '#f8f9fa',
                    padding: '12px',
                    borderRadius: '6px',
                    borderLeft: '4px solid #3498db'
                  }}>
                    <strong style={{
                      color: '#2c3e50',
                      display: 'block',
                      marginBottom: '4px',
                      fontSize: 'clamp(0.8rem, 2.5vw, 0.9rem)'
                    }}>
                      ‡∏°‡∏ß‡∏•‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏ï‡∏∏‡πâ‡∏° (m):
                    </strong>
                    {mass.toFixed(2)} ‡∏Å‡∏¥‡πÇ‡∏•‡∏Å‡∏£‡∏±‡∏°
                  </div>
                </div>
              </div>

              {/* ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ó‡∏≤‡∏á‡∏ó‡∏§‡∏©‡∏é‡∏µ */}
              <div style={{ marginBottom: '25px' }}>
                <h3 style={{
                  color: '#2c3e50',
                  borderBottom: '3px solid #3498db',
                  paddingBottom: '8px',
                  marginBottom: '15px',
                  fontSize: 'clamp(1.1rem, 3vw, 1.4rem)',
                  margin: '0 0 15px 0'
                }}>
                  üìä ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ó‡∏≤‡∏á‡∏ó‡∏§‡∏©‡∏é‡∏µ
                </h3>
                <table style={{
                  width: '100%',
                  borderCollapse: 'collapse',
                  margin: '15px 0',
                  background: 'white',
                  borderRadius: '6px',
                  overflow: 'hidden',
                  boxShadow: '0 3px 8px rgba(0, 0, 0, 0.1)',
                  fontSize: 'clamp(0.75rem, 2vw, 0.9rem)'
                }}>
                  <thead>
                    <tr>
                      <th style={{
                        background: 'linear-gradient(135deg, #3498db, #2980b9)',
                        color: 'white',
                        padding: '10px 6px',
                        textAlign: 'center',
                        fontWeight: '600'
                      }}>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                      <th style={{
                        background: 'linear-gradient(135deg, #3498db, #2980b9)',
                        color: 'white',
                        padding: '10px 6px',
                        textAlign: 'center',
                        fontWeight: '600'
                      }}>‡∏Ñ‡πà‡∏≤‡∏ó‡∏§‡∏©‡∏é‡∏µ</th>
                      <th style={{
                        background: 'linear-gradient(135deg, #3498db, #2980b9)',
                        color: 'white',
                        padding: '10px 6px',
                        textAlign: 'center',
                        fontWeight: '600'
                      }}>‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                      <th style={{
                        background: 'linear-gradient(135deg, #3498db, #2980b9)',
                        color: 'white',
                        padding: '10px 6px',
                        textAlign: 'center',
                        fontWeight: '600'
                      }}>‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr style={{ backgroundColor: '#f8f9fa' }}>
                      <td style={{
                        padding: '8px 6px',
                        textAlign: 'center',
                        borderBottom: '1px solid #eee'
                      }}>
                        <strong>‡∏Ñ‡∏≤‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡∏ß‡πà‡∏á (T)</strong>
                      </td>
                      <td style={{
                        padding: '8px 6px',
                        textAlign: 'center',
                        borderBottom: '1px solid #eee'
                      }}>
                        {pendulum.getTheoreticalPeriod().toFixed(4)}
                      </td>
                      <td style={{
                        padding: '8px 6px',
                        textAlign: 'center',
                        borderBottom: '1px solid #eee'
                      }}>
                        ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
                      </td>
                      <td style={{
                        padding: '8px 6px',
                        textAlign: 'center',
                        borderBottom: '1px solid #eee'
                      }}>
                        T = 2œÄ‚àö(L/g)
                      </td>
                    </tr>
                    <tr>
                      <td style={{
                        padding: '8px 6px',
                        textAlign: 'center',
                        borderBottom: '1px solid #eee'
                      }}>
                        <strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà (f)</strong>
                      </td>
                      <td style={{
                        padding: '8px 6px',
                        textAlign: 'center',
                        borderBottom: '1px solid #eee'
                      }}>
                        {pendulum.getTheoreticalFrequency().toFixed(4)}
                      </td>
                      <td style={{
                        padding: '8px 6px',
                        textAlign: 'center',
                        borderBottom: '1px solid #eee'
                      }}>
                        ‡πÄ‡∏Æ‡∏¥‡∏£‡πå‡∏ï
                      </td>
                      <td style={{
                        padding: '8px 6px',
                        textAlign: 'center',
                        borderBottom: '1px solid #eee'
                      }}>
                        f = 1/T
                      </td>
                    </tr>
                    <tr style={{ backgroundColor: '#f8f9fa' }}>
                      <td style={{
                        padding: '8px 6px',
                        textAlign: 'center',
                        borderBottom: '1px solid #eee'
                      }}>
                        <strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà‡πÄ‡∏ä‡∏¥‡∏á‡∏°‡∏∏‡∏° (œâ)</strong>
                      </td>
                      <td style={{
                        padding: '8px 6px',
                        textAlign: 'center',
                        borderBottom: '1px solid #eee'
                      }}>
                        {(2 * Math.PI * pendulum.getTheoreticalFrequency()).toFixed(4)}
                      </td>
                      <td style={{
                        padding: '8px 6px',
                        textAlign: 'center',
                        borderBottom: '1px solid #eee'
                      }}>
                        ‡πÄ‡∏£‡πÄ‡∏î‡∏µ‡∏¢‡∏ô/‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
                      </td>
                      <td style={{
                        padding: '8px 6px',
                        textAlign: 'center',
                        borderBottom: '1px solid #eee'
                      }}>
                        œâ = 2œÄf
                      </td>
                    </tr>
                    <tr>
                      <td style={{
                        padding: '8px 6px',
                        textAlign: 'center',
                        borderBottom: '1px solid #eee'
                      }}>
                        <strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πà‡∏á‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (a_max)</strong>
                      </td>
                      <td style={{
                        padding: '8px 6px',
                        textAlign: 'center',
                        borderBottom: '1px solid #eee'
                      }}>
                        {(gravity * Math.sin(angle * Math.PI / 180)).toFixed(4)}
                      </td>
                      <td style={{
                        padding: '8px 6px',
                        textAlign: 'center',
                        borderBottom: '1px solid #eee'
                      }}>
                        ‡πÄ‡∏°‡∏ï‡∏£/‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ¬≤
                      </td>
                      <td style={{
                        padding: '8px 6px',
                        textAlign: 'center',
                        borderBottom: '1px solid #eee'
                      }}>
                        a_max = g sin Œ∏‚ÇÄ
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>

              {/* ‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà */}
              <div style={{ marginBottom: '25px' }}>
                <h3 style={{
                  color: '#2c3e50',
                  borderBottom: '3px solid #3498db',
                  paddingBottom: '8px',
                  marginBottom: '15px',
                  fontSize: 'clamp(1.1rem, 3vw, 1.4rem)',
                  margin: '0 0 15px 0'
                }}>
                  üßÆ ‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà
                </h3>
                <div style={{
                  background: '#f0f8ff',
                  border: '2px solid #3498db',
                  borderRadius: '8px',
                  padding: '15px',
                  margin: '15px 0',
                  textAlign: 'center'
                }}>
                  <h4 style={{
                    color: '#2c3e50',
                    marginBottom: '12px',
                    fontSize: 'clamp(1rem, 2.5vw, 1.1rem)',
                    margin: '0 0 12px 0'
                  }}>
                    ‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ö‡∏ö‡∏Æ‡∏≤‡∏£‡πå‡∏°‡∏≠‡∏ô‡∏¥‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏á‡πà‡∏≤‡∏¢
                  </h4>
                  <div style={{
                    fontFamily: "'Times New Roman', serif",
                    fontSize: 'clamp(1rem, 2.5vw, 1.2rem)',
                    color: '#2980b9',
                    margin: '8px 0'
                  }}>
                    x(t) = A sin(œât + œÜ)
                  </div>
                  <div style={{
                    fontFamily: "'Times New Roman', serif",
                    fontSize: 'clamp(1rem, 2.5vw, 1.2rem)',
                    color: '#2980b9',
                    margin: '8px 0'
                  }}>
                    v(t) = Aœâ cos(œât + œÜ)
                  </div>
                  <div style={{
                    fontFamily: "'Times New Roman', serif",
                    fontSize: 'clamp(1rem, 2.5vw, 1.2rem)',
                    color: '#2980b9',
                    margin: '8px 0'
                  }}>
                    a(t) = -Aœâ¬≤ sin(œât + œÜ)
                  </div>
                  <div style={{
                    fontFamily: "'Times New Roman', serif",
                    fontSize: 'clamp(1rem, 2.5vw, 1.2rem)',
                    color: '#2980b9',
                    margin: '8px 0'
                  }}>
                    T = 2œÄ‚àö(L/g)
                  </div>
                  <div style={{
                    fontFamily: "'Times New Roman', serif",
                    fontSize: 'clamp(1rem, 2.5vw, 1.2rem)',
                    color: '#2980b9',
                    margin: '8px 0'
                  }}>
                    f = 1/T = (1/2œÄ)‚àö(g/L)
                  </div>
                </div>
              </div>

              {/* ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á */}
              {experimentData.length > 0 ? (
                <div style={{ marginBottom: '25px' }}>
                  <h3 style={{
                    color: '#2c3e50',
                    borderBottom: '3px solid #3498db',
                    paddingBottom: '8px',
                    marginBottom: '15px',
                    fontSize: 'clamp(1.1rem, 3vw, 1.4rem)',
                    margin: '0 0 15px 0'
                  }}>
                    üìà ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á (Real-time Data)
                  </h3>
                  <p><strong>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:</strong> {experimentData.length} ‡∏à‡∏∏‡∏î</p>
                  <p><strong>‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á:</strong> {experimentData.length > 0 ? experimentData[experimentData.length - 1].time.toFixed(2) : 0} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</p>
                  
                  <table style={{
                    width: '100%',
                    borderCollapse: 'collapse',
                    margin: '15px 0',
                    background: 'white',
                    borderRadius: '6px',
                    overflow: 'hidden',
                    boxShadow: '0 3px 8px rgba(0, 0, 0, 0.1)',
                    fontSize: 'clamp(0.75rem, 2vw, 0.9rem)'
                  }}>
                    <thead>
                      <tr>
                        <th style={{
                          background: 'linear-gradient(135deg, #3498db, #2980b9)',
                          color: 'white',
                          padding: '10px 6px',
                          textAlign: 'center',
                          fontWeight: '600'
                        }}>‡πÄ‡∏ß‡∏•‡∏≤ (s)</th>
                        <th style={{
                          background: 'linear-gradient(135deg, #3498db, #2980b9)',
                          color: 'white',
                          padding: '10px 6px',
                          textAlign: 'center',
                          fontWeight: '600'
                        }}>‡∏°‡∏∏‡∏° (¬∞)</th>
                        <th style={{
                          background: 'linear-gradient(135deg, #3498db, #2980b9)',
                          color: 'white',
                          padding: '10px 6px',
                          textAlign: 'center',
                          fontWeight: '600'
                        }}>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á (m)</th>
                        <th style={{
                          background: 'linear-gradient(135deg, #3498db, #2980b9)',
                          color: 'white',
                          padding: '10px 6px',
                          textAlign: 'center',
                          fontWeight: '600'
                        }}>‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß (m/s)</th>
                        <th style={{
                          background: 'linear-gradient(135deg, #3498db, #2980b9)',
                          color: 'white',
                          padding: '10px 6px',
                          textAlign: 'center',
                          fontWeight: '600'
                        }}>‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πà‡∏á (m/s¬≤)</th>
                        <th style={{
                          background: 'linear-gradient(135deg, #3498db, #2980b9)',
                          color: 'white',
                          padding: '10px 6px',
                          textAlign: 'center',
                          fontWeight: '600'
                        }}>‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô (J)</th>
                      </tr>
                    </thead>
                    <tbody>
                      {experimentData
                        .filter((_, index) => index % 5 === 0)
                        .slice(0, 50)
                        .map((data, index) => (
                          <tr key={index} style={{
                            backgroundColor: index % 2 === 0 ? '#f8f9fa' : 'white'
                          }}>
                            <td style={{
                              padding: '8px 6px',
                              textAlign: 'center',
                              borderBottom: '1px solid #eee'
                            }}>
                              {data.time.toFixed(3)}
                            </td>
                            <td style={{
                              padding: '8px 6px',
                              textAlign: 'center',
                              borderBottom: '1px solid #eee'
                            }}>
                              {data.angle.toFixed(2)}
                            </td>
                            <td style={{
                              padding: '8px 6px',
                              textAlign: 'center',
                              borderBottom: '1px solid #eee'
                            }}>
                              {data.position.toFixed(4)}
                            </td>
                            <td style={{
                              padding: '8px 6px',
                              textAlign: 'center',
                              borderBottom: '1px solid #eee'
                            }}>
                              {data.velocity.toFixed(4)}
                            </td>
                            <td style={{
                              padding: '8px 6px',
                              textAlign: 'center',
                              borderBottom: '1px solid #eee'
                            }}>
                              {data.acceleration.toFixed(4)}
                            </td>
                            <td style={{
                              padding: '8px 6px',
                              textAlign: 'center',
                              borderBottom: '1px solid #eee'
                            }}>
                              {data.energy.toFixed(4)}
                            </td>
                          </tr>
                        ))}
                    </tbody>
                  </table>
                  <p style={{
                    fontSize: '12px',
                    color: '#666',
                    marginTop: '10px'
                  }}>
                    <strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong> ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á (‡∏ó‡∏∏‡∏Å 5 ‡∏à‡∏∏‡∏î) ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î {experimentData.length} ‡∏à‡∏∏‡∏î
                    ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
                  </p>
                </div>
              ) : (
                <div style={{ marginBottom: '25px' }}>
                  <h3 style={{
                    color: '#2c3e50',
                    borderBottom: '3px solid #3498db',
                    paddingBottom: '8px',
                    marginBottom: '15px',
                    fontSize: 'clamp(1.1rem, 3vw, 1.4rem)',
                    margin: '0 0 15px 0'
                  }}>
                    üìà ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á
                  </h3>
                  <p style={{
                    color: '#666',
                    fontStyle: 'italic'
                  }}>
                    ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏•‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                  </p>
                </div>
              )}

              {/* ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á */}
              <div style={{ marginBottom: '25px' }}>
                <h3 style={{
                  color: '#2c3e50',
                  borderBottom: '3px solid #3498db',
                  paddingBottom: '8px',
                  marginBottom: '15px',
                  fontSize: 'clamp(1.1rem, 3vw, 1.4rem)',
                  margin: '0 0 15px 0'
                }}>
                  üìù ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á
                </h3>
                <p><strong>‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå:</strong> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ö‡∏ö‡∏Æ‡∏≤‡∏£‡πå‡πÇ‡∏°‡∏ô‡∏¥‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏ï‡∏∏‡πâ‡∏° ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏≤‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡∏ß‡πà‡∏á</p>
                
                <p><strong>‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£:</strong> ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ö‡∏ö‡∏Æ‡∏≤‡∏£‡πå‡πÇ‡∏°‡∏ô‡∏¥‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏ï‡∏∏‡πâ‡∏°‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏£‡∏á‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ï‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏ï‡∏∏‡πâ‡∏°‡πÅ‡∏õ‡∏£‡∏ú‡∏±‡∏ô‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏à‡∏±‡∏î‡πÄ‡∏ä‡∏¥‡∏á‡∏°‡∏∏‡∏° ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏™‡∏°‡∏Å‡∏≤‡∏£ F = -mgsinŒ∏</p>
                
                <p><strong>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á:</strong></p>
                <ul style={{
                  marginLeft: '20px',
                  lineHeight: 1.8
                }}>
                  <li>‡∏Ñ‡∏≤‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡∏ß‡πà‡∏á: {pendulum.getTheoreticalPeriod().toFixed(3)} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</li>
                  <li>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏ô: {pendulum.getTheoreticalFrequency().toFixed(3)} Hz</li>
                  <li>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà‡πÄ‡∏ä‡∏¥‡∏á‡∏°‡∏∏‡∏°: {(2 * Math.PI * pendulum.getTheoreticalFrequency()).toFixed(3)} rad/s</li>
                  <li>‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πà‡∏á‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: {(gravity * Math.sin(angle * Math.PI / 180)).toFixed(3)} m/s¬≤</li>
                </ul>
                
                <p><strong>‡∏Ç‡πâ‡∏≠‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï:</strong></p>
                <ul style={{
                  marginLeft: '20px',
                  lineHeight: 1.8
                }}>
                  <li>‡∏Ñ‡∏≤‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡∏ß‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏ï‡∏∏‡πâ‡∏°‡πÑ‡∏°‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏°‡∏ß‡∏•‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏ï‡∏∏‡πâ‡∏°</li>
                  <li>‡∏Ñ‡∏≤‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡∏ß‡πà‡∏á‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ç‡∏≠‡∏á‡πÄ‡∏ä‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô</li>
                  <li>‡∏Ñ‡∏≤‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡∏ß‡πà‡∏á‡∏à‡∏∞‡∏•‡∏î‡∏•‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏£‡∏á‡πÇ‡∏ô‡πâ‡∏°‡∏ñ‡πà‡∏ß‡∏á‡πÇ‡∏•‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô</li>
                  <li>‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∏‡∏°‡πÄ‡∏•‡πá‡∏Å (&lt; 15¬∞) ‡∏™‡∏°‡∏Å‡∏≤‡∏£ T = 2œÄ‚àö(L/g) ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥</li>
                </ul>
                
                <p><strong>‡∏™‡∏£‡∏∏‡∏õ:</strong> ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏ï‡∏∏‡πâ‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ö‡∏ö‡∏Æ‡∏≤‡∏£‡πå‡πÇ‡∏°‡∏ô‡∏¥‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏á‡πà‡∏≤‡∏¢ ‡πÇ‡∏î‡∏¢‡∏Ñ‡∏≤‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡∏ß‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ç‡∏≠‡∏á‡∏™‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡πÅ‡∏£‡∏á‡πÇ‡∏ô‡πâ‡∏°‡∏ñ‡πà‡∏ß‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÑ‡∏°‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏°‡∏ß‡∏•‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏ï‡∏∏‡πâ‡∏°</p>
              </div>

              <div style={{
                textAlign: 'center',
                marginTop: '25px',
                paddingTop: '15px',
                borderTop: '2px solid #eee'
              }}>
                <button
                  style={{
                    border: 'none',
                    padding: '10px 20px',
                    borderRadius: '6px',
                    fontSize: 'clamp(14px, 2.5vw, 16px)',
                    fontWeight: '600',
                    cursor: 'pointer',
                    margin: '5px',
                    background: 'linear-gradient(135deg, #f39c12, #e67e22)',
                    color: 'white',
                    touchAction: 'manipulation'
                  }}
                  onClick={copyReportData}
                >
                  üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
                </button>
              </div>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

export default PendulumLab;
